<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="Barbershop athens, Barbershop peristeri">
    <meta name="description" content="Barbershop στο Περιστέρι της Αθήνας, κλείσε ραντεβού σήμερα! ">

    <!-- Title -->
    <title>Μικρό Χόλιγουντ - Official Website</title>

    <!-- Favicon -->
    <link rel="icon" href="nav/favicon.ico">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">

    <!-- CSS Libraries -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="animate/animate.min.css" rel="stylesheet">
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="lib/lightbox/css/lightbox.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet">
    
    <!-- Custom Stylesheet -->
    <link href="css/style.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Top Bar Start -->
    <div class="custom-navbar">
        <div class="top-bar d-none d-md-block">
            <div class="container-fluid">
                <div class="row">
                    <!-- Left Section -->
                    <div class="col-md-6">
                        <div class="top-bar-left">
                            <div class="text">
                                <h2><a href="tel:+302160034661">21&nbsp;6003&nbsp;4661</a></h2>
                                <p>Τηλέφωνο επικοινωνίας</p>
                            </div>
                        </div>
                    </div>
                    <!-- Right Section -->
                    <div class="col-md-6">
                        <div class="top-bar-right">
                            <div class="social">
                                <a href="https://www.facebook.com/MikroHollywood/" target="_blank">
                                    <i class="fab fa-facebook-f"></i>
                                </a>
                                <a href="https://www.instagram.com/mikrohollywood/" target="_blank">
                                    <i class="fab fa-instagram"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navbar -->
        <div class="container-fluid d-flex align-items-center justify-content-between">
            <!-- Left: Brand -->
            <div class="brand d-flex align-items-center">
                <span class="brand-text">Το&nbsp;μικρό</span>&nbsp; <span class="brand-text hollywood">Χόλιγουντ</span>
                <img src="nav/star-logo.png" alt="Star Logo" class="star-logo ml-2">
            </div>
        </div>
        <!-- Navigation Links -->
        <nav class="navbar navbar-expand-lg">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
                <span class="navbar-toggler-icon"></span>
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link active" href="index.html">ΑΡΧΙΚΗ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="portfolio.html">ΓΚΑΛΕΡΙ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="contact.html">ΕΠΙΚΟΙΝΩΝΙΑ</a>
                    </li>
                </ul>
            </div>
        </nav>
    </div>

    <!-- Hero Start -->
    <div class="hero">
        <div class="container-fluid">
            <div class="row">
                <!-- Hero Text Section -->
                <div class="col-md-6 hero-text">
                    <h1>Ένα μικρό χολιγουντιανό καμαρίνι εποχής στο Περιστέρι! ⭐️ 🎞️ 📽️</h1>
                    <a class="btn hero-button" href="#contact">Κλείσε Ραντεβού!✂️</a> 
                </div>

                <!-- Hero Image Container -->
                <div class="hero-image-container">
                    <div class="album">
                        <!-- Dynamic Album Images -->
                        <img src="img/1.png" alt="Album Image 1">
                        <img src="img/2.png" alt="Album Image 2">
                        <img src="img/3.png" alt="Album Image 3">
                        <img src="img/4.png" alt="Album Image 4">
                        <img src="img/5.png" alt="Album Image 5">
                        <img src="img/6.png" alt="Album Image 6">
                    </div>
                    <a class="btn" href="portfolio.html">Δείτε την Γκαλερί μας!</a>
                </div>
            </div>
        </div>
    </div>

  <!-- Contact Start -->
<div class="contact" id="contact">
    <div class="container-fluid">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-4"></div>
                <div class="col-md-8">
                    <div class="contact-form">
                        <h3>Κλείσε Ραντεβού!</h3>
                        <form id="bookingForm">
                            <div class="control-group">
                                <label for="name">Το όνομά σας:</label>
                                <input type="text" class="form-control" id="name" placeholder="Ονοματεπώνυμο" required />
                            </div>

                            <div class="control-group">
                                <label for="phone">Ο αριθμός τηλεφώνου σας:</label>
                                <input type="tel" class="form-control" id="phone" placeholder="Τηλέφωνο επικοινωνίας" required />
                            </div>

                            <div class="control-group">
                                <label for="email">Το email σας:</label>
                                <input type="email" class="form-control" id="email" placeholder="Ηλεκτρονική διεύθυνση" required />
                            </div>

                            <div class="control-group">
                                <label for="appointment-date">Επιλέξτε ημερομηνία:</label>
                                <input type="text" class="form-control" id="appointment-date" placeholder="Πατήστε για να επιλέξετε μέρα" required />
                            </div>

                            <div class="control-group">
                                <label for="appointment-time">Επιλέξτε ώρα:</label>
                                <select class="form-control" id="appointment-time" required>
                                    <!-- Time slots will be populated here -->
                                </select>
                            </div>

                            <div>
                                <button class="btn" type="submit">Κάνε Κράτηση</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Contact End -->

  <!-- Modal -->
<div id="appointmentModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <!-- Confirmation Modal Content -->
        <div id="confirmationContent">
            <div class="modal-header">Επιβεβαίωση Ραντεβού</div>
            <div class="modal-body">
                Είστε σίγουροι ότι θέλετε να καταχωρηθεί αυτό το ραντεβού;
            </div>
            <div class="modal-footer">
                <button class="btn" id="confirmYesBtn">Ναι</button>
                <button class="btn" id="confirmNoBtn">Όχι</button>
            </div>
        </div>
        <!-- Success Modal Content -->
        <div id="successContent" style="display: none;">
            <div class="modal-header">Επιβεβαίωση Ραντεβού</div>
            <div class="modal-body">
                Το ραντεβού σας έχει καταχωρηθεί επιτυχώς! Θα λάβετε επιβεβαίωση μέσω email.
            </div>
            <div class="modal-footer">
                <button class="btn" id="modalCloseBtn">Κλείσιμο</button>
            </div>
        </div>
    </div>
</div>

    <!-- Footer -->
    <div class="footer">
        <div class="container">
            <div class="row align-items-center">
                <!-- Footer Information -->
                <div class="col-lg-7 col-md-8">
                    <div class="footer-contact">
                        <h2>Διέυθυνση&nbsp;Barber&nbsp;shop</h2>
                        <p><i class="fa fa-map-marker-alt"></i>Καβάλας&nbsp;187,&nbsp;Περιστέρι&nbsp;121&nbsp;36</p>
                        <p><i class="fa fa-phone-alt"></i>21&nbsp;6003&nbsp;4661</p>
                        <p><i class="fa fa-envelope"></i>mikroHollywood@gmail.com</p>
                        <div class="footer-social">
                            <a href="https://www.facebook.com/MikroHollywood/"><i class="fab fa-facebook-f"></i></a>
                            <a href="https://www.instagram.com/mikrohollywood/"><i class="fab fa-instagram"></i></a>
                        </div>
                    </div>
                </div>

                <!-- Map Section -->
                <div class="col-lg-5 col-md-4">
                    <div class="map-container footer-map">
                        <iframe 
                            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3143.786277003955!2d23.67533287644532!3d38.005445298838076!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x14a1a352c31ae061%3A0xaccf50074b00bb78!2sKavalas%20187%2C%20Peristeri%20121%2036!5e0!3m2!1sen!2sgr!4v1737560630507!5m2!1sen!2sgr"
                            allowfullscreen=""
                            loading="lazy"
                            referrerpolicy="no-referrer-when-downgrade">
                        </iframe>
                    </div>
                </div>
            </div>
        </div>

        <div class="container copyright">
            <div class="row">
                <div class="col-md-6">
                    <p>&copy; <a href="#">To&nbsp;mikro&nbsp;Hollywood</a>, All Right Reserved.</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/gr.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="lib/isotope/isotope.pkgd.min.js"></script>
    <script src="lib/lightbox/js/lightbox.min.js"></script>

    <!-- Contact Javascript File -->
    <script src="/jqBootstrapValidation.min.js"></script>
    <script src="mail/contact.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>

    <script>
        const storeHours = {
            "Παρασκευή": ["12:00", "20:00"],
            "Σάββατο": ["10:00", "17:00"],
            "Κυριακή": null,
            "Δευτέρα": null,
            "Τρίτη": ["12:00", "20:00"],
            "Τετάρτη": ["10:00", "15:00"],
            "Πέμπτη": ["12:00", "20:00"]
        };
    
        const dayNamesInGreek = ["Κυριακή", "Δευτέρα", "Τρίτη", "Τετάρτη", "Πέμπτη", "Παρασκευή", "Σάββατο"];
    
        flatpickr.localize(flatpickr.l10ns.gr); // Localize to Greek
        flatpickr("#appointment-date", {
            dateFormat: "d/m/Y",
            minDate: "today",
            maxDate: new Date().fp_incr(14),
            onChange: async function(selectedDates, dateStr, instance) {
                const selectedDate = selectedDates[0];
                const dayOfWeek = dayNamesInGreek[selectedDate.getDay()];
                const timeslotSelect = document.getElementById("appointment-time");
    
                timeslotSelect.innerHTML = "";
    
                if (storeHours[dayOfWeek]) {
                    let [start, end] = storeHours[dayOfWeek];
                    let startTime = new Date(selectedDate);
                    let endTime = new Date(selectedDate);
    
                    startTime.setHours(start.split(":")[0], start.split(":")[1]);
                    endTime.setHours(end.split(":")[0], end.split(":")[1]);
    
                    const bookedSlots = await fetchBookedSlots(formatDate(selectedDate));
    
                    // Get the current time if the selected date is today
                    const now = new Date();
                    if (selectedDate.toDateString() === now.toDateString()) {
                        startTime = new Date(Math.max(startTime, now));
                        startTime.setMinutes(Math.ceil(startTime.getMinutes() / 30) * 30); // Round to the next 30 minutes
                    }
    
                    for (let time = startTime; time < endTime; time.setMinutes(time.getMinutes() + 30)) {
                        const timeString = time.toTimeString().substr(0, 5);
                        const option = document.createElement("option");
    
                        if (!bookedSlots.includes(timeString)) {
                            option.value = timeString;
                            option.textContent = timeString;
                            timeslotSelect.appendChild(option);
                        }
                    }
                } else {
                    const option = document.createElement("option");
                    option.textContent = "Κλειστά";
                    timeslotSelect.appendChild(option);
                }
            }
        });
    
        async function fetchBookedSlots(date) {
            const response = await fetch(`http://localhost:5000/booked-slots?date=${date}`);
            const data = await response.json();
            return data.bookedSlots || [];
        }
    
        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }
        
        document.addEventListener("DOMContentLoaded", function() {
            // Get the modal elements
            var modal = document.getElementById("appointmentModal");
            var confirmationContent = document.getElementById("confirmationContent");
            var successContent = document.getElementById("successContent");
    
            // Ensure modal element is found
            if (!modal) {
                console.error("Modal element not found!");
                return;
            }
    
            // Get the close elements
            var span = document.getElementsByClassName("close")[0];
            var closeBtn = document.getElementById("modalCloseBtn");
    
            // Get the confirmation buttons
            var confirmYesBtn = document.getElementById("confirmYesBtn");
            var confirmNoBtn = document.getElementById("confirmNoBtn");
    
            // Get the form
            var bookingForm = document.getElementById("bookingForm");
    
            // Flag to check if the form should be submitted
            var shouldSubmitForm = false;
    
            // Open the modal with confirmation content
            function openModal() {
                modal.style.display = "block";
                confirmationContent.style.display = "block";
                successContent.style.display = "none";
            }
    
            // Close the modal
            function closeModal() {
                modal.style.display = "none";
            }
    
            // Handle form submission
            bookingForm.addEventListener("submit", function(event) {
                event.preventDefault(); // Prevent form from submitting
    
                if (!shouldSubmitForm) {
                    openModal();
                } else {
                    shouldSubmitForm = false;
                    submitForm();
                }
            });
    
            // Handle 'Yes' button click
            confirmYesBtn.addEventListener("click", function() {
                shouldSubmitForm = true;
                closeModal();
                submitForm();
            });
    
            // Handle 'No' button click
            confirmNoBtn.addEventListener("click", function() {
                closeModal();
            });
    
            // Handle <span> (x) click to close the modal
            span.onclick = function() {
                closeModal();
            }
    
            // Handle close button click
            closeBtn.onclick = function() {
                closeModal();
            }
    
            // Close the modal if the user clicks outside the modal content
            window.onclick = function(event) {
                if (event.target == modal) {
                    closeModal();
                }
            }
    
            // Function to submit the form data via AJAX
            async function submitForm() {
                const name = document.getElementById("name").value;
                const phone = document.getElementById("phone").value;
                const email = document.getElementById("email").value;
                const appointmentDate = document.getElementById("appointment-date").value;
                const appointmentTime = document.getElementById("appointment-time").value;
                const userId = 1; // Assuming user_id is fixed or obtained from another logic
    
                if (!name || !phone || !email || !appointmentDate || !appointmentTime) {
                    alert("Παρακαλώ συμπληρώστε όλα τα πεδία.");
                    return;
                }
    
                try {
                    const response = await fetch("http://localhost:5000/appointments", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({
                            user_id: userId,
                            name: name,
                            phone: phone,
                            email: email,
                            appointment_date: appointmentDate,
                            appointment_time: appointmentTime
                        }),
                    });
    
                    if (!response.ok) {
                        throw new Error("Η κράτηση απέτυχε.");
                    }
    
                    // Show the success content
                    confirmationContent.style.display = "none";
                    successContent.style.display = "block";
                    modal.style.display = "block"; // Ensure modal is open to display success content
                } catch (error) {
                    console.error("Σφάλμα:", error);
                    alert("Παρουσιάστηκε σφάλμα κατά την κράτηση.");
                }
            }
        });
    </script>
</body>
</html>